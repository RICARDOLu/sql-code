6 查找所有员工入职时候的薪水情况，给出emp_no以及salary， 并按照emp_no进行逆序(请注意，一个员工可能有多次涨薪的情况)
select s.emp_no,s.salary 
from employees e left join salaries s on e.emp_no=s.emp_no and 
e.hire_date = s.from_date
order by e.emp_no DESC;

7.查找薪水变动超过15次的员工号emp_no以及其对应的变动次数t   having 与where的区别
select emp_no,count(distinct salary) from salaries
group by emp_no
having count(distinct salary)>15;

9.获取所有部门当前(dept_manager.to_date='9999-01-01')manager的当前(salaries.to_date='9999-01-01')薪水情况，给出dept_no, emp_no以及salary，输出结果按照dept_no升序排列
//注意并非dept_manager left join salaries 因为左表可能有过去的manager信息所以不能全部输出
select d.dept_no,d.emp_no,s.salary 
from dept_manager d join salaries s 
on d.emp_no = s.emp_no and d.to_date=s.to_date and s.to_date = '9999-01-01'
order by d.dept_no;

11.获取所有部门中当前(dept_emp.to_date = '9999-01-01')员工当前(salaries.to_date='9999-01-01')薪水最高的相关信息，给出dept_no, emp_no以及其对应的salary，按照部门编号升序排列。
select d.dept_no,s.emp_no,s.salary
from salaries s join dept_emp d
on s.emp_no=d.emp_no and s.to_date='9999-01-01' and d.to_date='9999-01-01' 
and s.salary = (
    select max(s1.salary)
    from salaries s1 join dept_emp d1 on
    s1.to_date='9999-01-01' and d1.to_date='9999-01-01' and s1.emp_no=d1.emp_no
    and d1.dept_no = d.dept_no
    group by d1.dept_no
)
order by d.dept_no;

18.查找当前薪水(to_date='9999-01-01')排名第二多的员工编号emp_no、薪水salary、last_name以及first_name，你可以不使用order by完成吗
通用型可以求任意第几高，并且可以求多个形同工资
select e.emp_no,s.salary,e.last_name,e.first_name
from
employees e
join 
salaries s on e.emp_no=s.emp_no 
and  s.to_date='9999-01-01'
and s.salary = 
(
     select s1.salary
     from 
     salaries s1
     join
     salaries s2 on s1.salary<=s2.salary 
     and s1.to_date='9999-01-01' and s2.to_date='9999-01-01'
     group by s1.salary
     having count(distinct s2.salary)=2
 )

